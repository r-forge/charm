2009-12-09 v0.9.12
  Added dmrFdr and the imports pi0.est, qvalue.cal from siggenes, 
	combinations from gtools
  Added prettyTime 
  Added commonMethPercentParams option to methp. Defaults to true for quantile 
   norm and false for sqn, sqn99

2009-12-08 v0.9.11
  Modified K calculation in dmrFinder to ignore NAs
  qcReport now uses the number of probes on the array for small arrays (rather
    than the default 500000)
  Added a check in readCharm that gives a helpful error if the filenames do 
    not match the expected defaults

2009-12-06 v0.9.10 
  Fixed a bug in qcReport that caused arrayImage to fail for OfflineTilingFeatureSet2
  Modified qcReport sd1 to be based on intensity (like sd2) rather than pmQuality
  Can now pass an annotation string to dmrFinder instead of a TilingFeatureSet2

2009-12-03 v0.9.9
  Fixed code to work with TilingFeatureSet2
  Changes normalizeBetweenSamples defaults to m="allQuantiles", untreated="none", enriched="none"
  qcReport now returns pmSignal and sd for the two channels
  Bug fix in spatialAdjust: bg probes weren't being corrected

2009-12-01 v0.9.8
  Added commonParams option to methPercent (default is TRUE)

2009-12-01 v0.9.7
  Changed useTot default to TRUE
  Efficiency improvements in arrayImage

2009-11-30 v0.9.6
  OfflineTilingFeatureSet2 now extends TilingFeatureSet instead of 
   TilingFeatureSet2 if oligo version >= 1.11

2009-11-20 v0.9.5
  Added msqn option

2009-11-19 v0.9.4
  Reintroduced polynomial surface spatial normalization as an option
  Added option to use total input channel intensity in affinity model
  Changed methp default binSize to 250
  Changed plotDensityCols to default to pd$type colors

2009-11-18 v0.9.3
  Fixed a bug in methp and normalizeWithinSamples where normalizeLoess
   was called without the cluster argument
  Added an approx option to normalizeLoess to which speeds up the loess 
   correction by binning the A-values  
  Changed normalizeWithinSamples default method to loess
  Renamed plotDensities to plotDensity2 to avoid conflict with limma

2009-11-16 v0.9.2
  Added plotDensity option to methp
  Fixed a bug in annotateDMR that caused it to fail when no DMRs met criteria
  Added withinSampleNorm="loess" option to methp 
  Added betweenSampleNorm="none" option to methp
  New normalization defaults: withinSampleNorm="loess", betweenSampleNorm="quantile"
  Modified affinity model by dropping tot^2 term.
  Changed default binSize for affinity calculation to 500

2009-11-09 v0.9.1
  Added bit (related to ff) to imports

2009-11-06 v0.9.0
  Branched for R-2.10 compatability breaking R-2.9 compatability
  Import physical from package bit instead of package ff
  Removed genefilter, spatial and splines from dependencies and imports
  Updated getControlIndex to allow multiple choices for the 
   control probe container column
  Updated read.xysfiles2.offline and read.celfiles2.offline for 	
    oligo:::getMetadata compatability
  Fixed a plotting bug in qcReport

2009-11-05 v0.8.22
  Added support for reading Affy data into disk based OfflineTilingFeatureSet2s
  Reduced memory use of methPercent with ff objects

2009-11-04 v0.8.21
  spatialAdjust now uses a kernel smoother instead of a polynomial spline
  qcReport now produces 3 quality metrics per array: signal strength, and the sd in 
   the smoothed plots from the two channels

2009-11-03 v0.8.20
  Modified methp to leave input data unmodified (by creating a working copy)
  Added simpler choices to methp's betweenSampleNorm: quantile, sqn, sqn99
  Modified methp to no longer filter out poor quality probes.
  Fixed a bug in methp that caused prevented the cluster child processes from being
   stopped at function exit

2009-11-02 v0.8.19
 Updated normQuantile to allow ff objects for all cases, including full quantile
   normalization. At the moment they are just converted to matrices and passed to
   normalize.quantiles and then converted back to ff objects.
 Fixed a bug in normalizeLoess
 Added cluster option to dmrFinder
 Updated dmrFinder to allow ff objects as return values from methp. At the moment it just
   converts them to regular matrices.

2009-10-28 v0.8.18
 Fixed a bug in affinityBin where the number of sample groups was incorrectly calculated.
 Fixed a bug in annotateDMRs that caused it to fail when no DMRs exist
 Modified methp to start cluster if requested with cluster option
 Added returnM option to methp to get M instead the default p
 Use ff by default (unless saveRam is set to FALSE in readCharm)

2009-10-24 v0.8.17
 Added support for parallel execution using snow. 

2009-10-18 v0.8.16
 Added bigRam option to readCharm

2009-10-15 v0.8.15
 Modified pmQuality to return a matrix with column names, and qcReport to allow unnamed samples.

2009-10-05 v0.8.14
 Modifed code to allow reduced ram usage through the (optional) use of disk-based objects 
	for large matrices and sample-by-sample processing. The ff package is used.
 Added bgSubtract option to dmrFinder 

2009-10-01 v0.8.13
 Fixed a bug in qcReport
 Modified affinityBin to allow class(dat) = matrix as well as TilingFeatureSet2
 Consolidated the files in the R directory
 Added new options to dmrFinder (Peter Murakami) including the ability to select 
  the pairwise comparisons of interest. Error-checking and other improvements also. 
 Modified arrayPlot to ceiling and floor plotted values to avoid white spots when
  values are outside the scale range.

2009-09-22 v0.8.12
 Updated makeSeqX: Added addInteractions option and changed return type from matrix to data 
   frame
 Updated makeX: can now specify a window="probe" or window=SIZE where SIZE is the size of 
 	a window centered on the probe.
 Updated getAffinity, makeSeqX, makeX with options to include A,C,G content of a window
	centered on the probe in the affinity model
 Added m option to normalizeBetweenSamples
 Added enriched=sqn option to normalizeBetweenSamples	
 Added SQN package to imports (it doesn't yet have a NAMESPACE)
 Renamed pmvsbg to pmQuality
 Updated dmrFinder to use new methp options
 Added regionFilter
 Updated annotateDMRs to allow peaks as well as DMRs

2009-08-23 v0.8.11
 Updated normalizeWithinSamples and getAffinity to enable 0-levelling within predicted affinity bins.
    This is the default.
 Fixed bug in normalizeWithinSamples where the na.rm option was passed to max.density causing an error
 Added findClosestGene, a slight modification of the version in the ACME package that allows for queries
    on chromosomes not present in the annotation file. This happens in, for example, Affy tiling arrays 
    that include mitochondrial region probes.
 Renamed methp's spatial adjust options to spatial1d (defatult off) and spatial2d (default on). 
 Added importFrom(ACME, getRefflat) to NAMESPACE

2009-08-04 v0.8.10
 Modified normalizeWithinSamples to not use GC content by default. Renamed diffAmpEst to diffAmpEstGC 
    and diffAmpAdjust to diffAmpAdjustGC
 Modified normalizeWithinSamples and diffAmpEstGC to use median instead of max.density by default   
 Added option for affinity based mapping (new default) during Enriched channel normalization. Modified getMap()
   and added makeX, addInteractions, makeSeqX, getAffinity. Modified normalizeBetweenSamples and normControlBg.
 Added cpgdensity()
 Added an option to getControlIndex() to allow identification of probes in CpG-free windows. This is particularly
   useful for arrays without annotated control probes, e.g. Affy tiling arrays
 Added option to normalizeWithinSamples to allow passing of control probe indices (instead of only Nimblegen 
   container name)
 Added (default) option to normalizeWithinSamples to use only 'good' control probes, i.e. to the right 
   of the elbow in the Channel 1 vs Channel 2 plot. 
 Added a temporary fix for the sampleNames problem where it returns a single sample name. 
   Redefined sampleNames as rownames(pData(dat))

2009-07-02 v0.8.9
 Modified annotateDMRs to handle gene annotation from a text file
 Modified dmrFinder to order probes by chr, pns, pos (instead of chr,pos). The previous version had trouble
  with the bee genome were unassembled sequences are all grouped under chromosome chr and are only ordered
  by pos within a pns
 
2009-07-01 v0.8.8
 Fixed a bug with sampleNames option in readCharm()

2009-06-30 v0.8.7
 Added sampleNames option to readCharm()
 Changed the default color scale in qcReport to make reports
  more easily comparable across experiments.Added a r (for range) option to arrayPlot(). 
  Added utRange and enRange options to qcReport to set the range. Setting these to NULL
  will choose a range that fits the data set.
 
2009-06-20 v0.8.6
 Added mouse annotation

2009-06-09 v0.8.5
 Renamed DMRFinder() to dmrFinder()
 Renamed the untreated/enriched headings in the qcReport
 Changed fixed=FALSE to fixed=TRUE in countSeq()'s vCountPattern() call 
 Added controlIndex option to normalizeBetweenSamples()
 Modified countSeq() to allow NA for chr
 Added suppressWarnings to countSeq() and annotateDMRs
 Modified annotateDMRs to allow M1,M2 as well as P1,P2

2009-06-04 v0.8.4 
 Added countSeq() function to count the number of occurences of a given sequence in a set of 
  regions defined by chr, start, stop
 Added closestTSS() 
 Added annotateDMRs()
 Added to NAMESPACE: importFrom(ACME, findClosestGene)
 Updated countGC() to use oligo's basecontent(). It's masked by Biostrings
 Fixed bug in qcReport that referred to rawData instead of dat
 Added to DMRFinder: groups <- as.character(groups)
 Minor documentation updates

2009-06-03 v0.8.3
 Modified readCharm() to not need a type assignment. 
 
2009-06-02 v0.8.2 
 Modified qcReport to retrun the array quality scores

2009-06-02 v0.8.1
 Reformatted the QC report
 
2009-06-02 v0.8.0
 Added Rafael's bumpfinder code. Added genefilter to NAMESPACE and DESCRIPTION.
 Updated between sample normalization code. The options for normalizing the enriched channel are now
   "control": use control probes only, "bg": use bg probes only, "controlBg": use both
 Updated readCharm to make more intelligent guesses  
 Updated pmvsbg to use bg probes of similar gc content if the pm probe's gc cannot be exactly matched
 Added qcReport() to produce a pdf array quality report

2009-05-29 v0.7.16
 Removed GC-stratification for control probe norm.
 Modified diffAmpEst to allow missing values for M and A

2009-05-27 v0.7.15
 Added 'ctrl' and 'bg' as normalization options for the enriched channel. Normalize within GC-strata

2009-05-25 v0.7.14
 Updated methp() to identify bad probes right after spatial correction

2009-05-22 v0.7.13
 Added controlProbes option to normalizeWithinSamples() and updated methp() to use it's controlProbes option.

2009-05-22 v0.7.12
 Added ... option to readCharm() that is passed through to read.xysfiles2(). 

2009-05-21 v0.7.11
 Added xlab option to plotDensity2()
 Added normalizeBetweenSamples() with options for quantile normalization of the UT channel
  and Zhijn's idea of using control probes for the enriched channel. Added normalizeBetweenSamples() 
  helper functions normQuantile(), normControlBg() and getMap(). 
 Added normalizeWithinSamples() as a wrapper for differential amplification adjustment 
 Modified normQuantile() to no longer use the arbitrary -log2(0.95) target.
 Added option to getControlIndex() for returning a matrix of control probe values (optionally with NAs for 
  below the "elbow")

2009-05-18 v0.7.10
 Added names to the list returned by getControlIndex(). It now defaults to returning all control indices.

2009-05-13 v0.7.9
 Fixed a bug in methPercent that was causing NAs

2009-05-13 v0.7.8
 Modified the -log(1-p) prior in logmethPost() to have a point mass at 0. For now the prior
  probability of -log(1-p)=0 is (roughly) estimated as the proportion of M<0
 Added getControlIndex() to return indices of 'good' control probes, i.e. to the 
  right of the elbow

2009-05-11 v0.7.7
 Renamed the package to charmR
 Added a (rough) vignette
 Added the annotation package pd.feinberg.hg18.me.hx1 to the Suggests line in DESCRIPTION

2009-05-10 v0.7.6
 Fixed a bug in arrayImage() that failed to name row and column images with the sample name.
 Updated the methp() verbose progress comments

2009-05-09 v0.7.5
 Added readCharm() to allow easier reading of CHARM xys files. A single path argument
  is all that's required.
 Removed the spatialMethod option from methp() and spatialAdjust(). We always use the 2d 
  polynomial surface option.  

2009-05-08 v0.7.4
 Starting adding documentation

2009-05-07 v0.7.3
 Updated code to use NChannelSet internally
 Modified logmeth.parameters() to estimate the normal sd within GC bins
 Modified diff.amp.adjust() to use at least 1/10 of control probes
  instead of 1/2
 Added arrayImage() and arrayPlot() to plot heatmaps of arrays
 Added countGC()
 Modified bg.adjust.bgp() to also adjust bg probes (maybe useful in calling 
   bad probes later on)
 Added demedian() and included is as a default option in spatial.adjust()
 Added pmvsbg() and dynamicRange()
 Renamed functions to camelCase
 
2009-04-24 v0.7.2
 Extended the quantileNorm option of methp() to accept:
  "full": full quantile normalization followed by scaling the 99% percentile
          to be 95% methylated
  "99": scale the 99% percentile to be 95% methylated
  "none": no between sample normalization

2009-04-23 v0.7.1
 This version is designed for oligo >= 1.8.1
 Updated extract() to read TilingFeatureSet2 (the output of read.xysfiles2 in
  oligo). The options used when calling methp() and extract() have changed
  as a result of thie change.
 Modified diff.amp.adjust() to use a weighted kernel smoothed estimate of
  the adjustment factor as a function of GC content
 Modified spatial.adjust() to center corrected values at median
  rather than 0
 Added reshapePd() - a simple wrapper to reshape() with option names that make
  more sense for multi-channel sample data
 Changed the default spatialMethod to 2d

2009-04-12 v0.7
 Added quantnorm()
 Added A to the methp list output object
 Estimate the normal sd in logmeth.parameters() by the MAD of M[M<0]
 A estimation by max density of flat portion of control probe MA plot
 Added checkBreakpoint()
 Modified extract to extract data from expressionset objects in addition to TilingFeatureSets
 Added method="spline" to spatial.adjust(), in addition to method="1d" (default)
 Modified est.log.A to handle multiple samples and gave it options for max density (default)
  and normexp estimation
 Modified logmeth.post to handle multiple samples
 Added qcflag() and we now take account of A when QC-flagging probes

2009-03-26 v0.6.1
 Added extract() function to extract data from the oligo TilingFeatureSet
   object into an internal list structure
 Modified spatial.adjust() to use the internal list data structure
 Added debatch()
 Modified bg.adjust.bgp() to handle multiple samples
 Added Rafa's myfilter() and myfilterse()
 Added smooth() to get group means and smoothed estimates of logit(p)
 Added genefilter for rowSds()

2009-03-17 v0.6
 Flag probes where one of the channels is at floor 
   or saturated levels and the other channel is within log2(0.05)
 Changed A correction to max(curve fit) 
 Added spatial effect correction

2009-02-25 v0.5
The following procedure is used to estimate the proportion of methylated DNA:
Background removal: 
  We fit an RMA-like model to each array where the background signal 
  is Normal(mu, s2) and the true signal is Exp(alpha). mu is estimated 
  by fitting a loess curve through the mode of the background probe
  distribution for each GC-content bin. s2 is calculated as usual
  but only using background probes. alpha are estimated 
  as usual using the signal probes
Differential amplification correction:
  We account for differential amplification by estimating a correction
  factor with a loess curve fit through the control probes (p=1).
Estimation of p
  We use the model S = tot-en = X+Y. 
  X = -log(1-p) ~ Exp(alpha) and Y ~ N(0, s2) 
  This is the similar to the RMA model except the normal is not 
  truncated and has mean 0. The posterior expectation of X|S is the same 
  as in the RMA model except for two factors that are ignored by RMA anyway.
  After calculating the posterior expectation of -log(1-p) we simply
  solve for p.

 
TO DO
 Need to add fix for a CHARM array annotation problem:
     Index=which(pns=="chr1:226808280-226853529")
     pns[Index[1:16]]="chr1:226808280-226810015"
     pns[Index[17:57]]="chr1:226849110-226850925"
     pns[Index[58:85]]="chr1:226852509-226853451"
